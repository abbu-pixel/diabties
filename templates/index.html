<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Diabetes Predictor</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .prediction-message {
            display: none;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
        }
        .prediction-message.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-100 to-blue-200 flex items-center justify-center min-h-screen p-4">
    <div class="bg-white p-8 md:p-12 rounded-3xl shadow-2xl w-full max-w-2xl transform transition-transform duration-300 hover:scale-105">
        <div class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-extrabold text-gray-800 tracking-tight">Advanced Diabetes Predictor</h1>
            <p class="mt-2 text-gray-500 text-sm md:text-base">Fill out the form below with your health metrics to get an instant prediction without page reload.</p>
        </div>
        
        <form id="predictionForm" class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <label for="glucose" class="block text-sm font-medium text-gray-700 mb-1">Glucose (mg/dL)</label>
                <input type="number" id="glucose" name="glucose" placeholder="e.g., 148" required min="0" class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200">
            </div>
            
            <div>
                <label for="blood_pressure" class="block text-sm font-medium text-gray-700 mb-1">Blood Pressure (mm Hg)</label>
                <input type="number" id="blood_pressure" name="blood_pressure" placeholder="e.g., 72" required min="0" class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200">
            </div>
            
            <div>
                <label for="skin_thickness" class="block text-sm font-medium text-gray-700 mb-1">Skin Thickness (mm)</label>
                <input type="number" id="skin_thickness" name="skin_thickness" placeholder="e.g., 35" required min="0" class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200">
            </div>
            
            <div>
                <label for="insulin" class="block text-sm font-medium text-gray-700 mb-1">Insulin (mu/L)</label>
                <input type="number" id="insulin" name="insulin" placeholder="e.g., 0" required min="0" class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200">
            </div>
            
            <div>
                <label for="bmi" class="block text-sm font-medium text-gray-700 mb-1">BMI (kg/mÂ²)</label>
                <input type="number" step="0.01" id="bmi" name="bmi" placeholder="e.g., 33.6" required min="0" class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200">
            </div>
            
            <div>
                <label for="diabetes_pedigree_function" class="block text-sm font-medium text-gray-700 mb-1">Diabetes Pedigree Function</label>
                <input type="number" step="0.01" id="diabetes_pedigree_function" name="diabetes_pedigree_function" placeholder="e.g., 0.627" required min="0" class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200">
            </div>
            
            <div>
                <label for="age" class="block text-sm font-medium text-gray-700 mb-1">Age (years)</label>
                <input type="number" id="age" name="age" placeholder="e.g., 50" required min="0" class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200">
            </div>
            
            <div class="md:col-span-2 relative mt-4">
                <button type="submit" id="submitBtn" class="w-full bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200">
                    Predict Diabetes
                </button>
            </div>
        </form>

        <!-- Prediction Result Container -->
        <div id="predictionResult" class="mt-8 prediction-message">
            <div id="messageBox" class="p-6 rounded-xl shadow-lg bg-green-50">
                <p id="resultText" class="text-green-800 font-semibold text-center"></p>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('predictionForm').addEventListener('submit', async function(event) {
            event.preventDefault(); // Prevent the default form submission (page reload)

            const form = event.target;
            const formData = new FormData(form);
            const submitBtn = document.getElementById('submitBtn');
            const resultDiv = document.getElementById('predictionResult');
            const resultText = document.getElementById('resultText');
            const messageBox = document.getElementById('messageBox');
            
            // Show loading state
            submitBtn.textContent = 'Predicting...';
            submitBtn.disabled = true;
            resultDiv.classList.remove('active');

            try {
                // Send a POST request to the Flask backend
                const response = await fetch('/predict', {
                    method: 'POST',
                    body: formData,
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                // Get the text from the response
                const result = await response.text();

                // Update the result message based on the prediction
                resultText.textContent = result;
                
                // Adjust message box styling based on prediction (e.g., green for non-diabetic, red for diabetic)
                if (result.includes("non-diabetic")) {
                    messageBox.classList.remove("bg-red-50", "border-red-500");
                    messageBox.classList.add("bg-green-50", "border-green-500");
                    resultText.classList.remove("text-red-800");
                    resultText.classList.add("text-green-800");
                } else {
                    messageBox.classList.remove("bg-green-50", "border-green-500");
                    messageBox.classList.add("bg-red-50", "border-red-500");
                    resultText.classList.remove("text-green-800");
                    resultText.classList.add("text-red-800");
                }
                
                // Animate the result message into view
                resultDiv.classList.add('active');

            } catch (error) {
                resultText.textContent = `Prediction failed. Error: ${error.message}`;
                messageBox.classList.remove("bg-green-50", "border-green-500");
                messageBox.classList.add("bg-yellow-50", "border-yellow-500");
                resultText.classList.remove("text-green-800");
                resultText.classList.add("text-yellow-800");
                resultDiv.classList.add('active');

            } finally {
                // Restore the button state
                submitBtn.textContent = 'Predict Diabetes';
                submitBtn.disabled = false;
            }
        });
    </script>
</body>
</html>
